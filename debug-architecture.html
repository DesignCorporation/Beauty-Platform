<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beauty Platform - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .flow-diagram {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
        }
        
        .step {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
        }
        
        .step:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .step-number {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .step-details {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .arrow {
            text-align: center;
            color: #3498db;
            font-size: 1.5em;
            margin: 10px 0;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .service-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .service-card:hover {
            border-color: #3498db;
            transform: translateY(-5px);
        }
        
        .service-card.active {
            border-color: #27ae60;
            background: #d5f4e6;
        }
        
        .service-card.error {
            border-color: #e74c3c;
            background: #fdf2f2;
        }
        
        .service-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-active { background: #27ae60; }
        .status-error { background: #e74c3c; }
        .status-unknown { background: #f39c12; }
        
        .service-info {
            font-size: 0.9em;
            color: #7f8c8d;
            line-height: 1.6;
        }
        
        .endpoints {
            margin-top: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .endpoint {
            margin: 5px 0;
            font-family: monospace;
            background: #fff;
            padding: 5px 8px;
            border-radius: 3px;
            font-size: 0.8em;
        }
        
        .problem-section {
            background: #fff5f5;
            border: 2px solid #fed7d7;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
        }
        
        .problem-title {
            color: #e53e3e;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .command-box {
            background: #1a202c;
            color: #68d391;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .test-results {
            margin-top: 30px;
        }
        
        .test-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9em;
        }
        
        .test-pass {
            background: #d4edda;
            color: #155724;
        }
        
        .test-fail {
            background: #f8d7da;
            color: #721c24;
        }
        
        .test-icon {
            margin-right: 10px;
            font-weight: bold;
        }
        
        .path-trace {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .path-step {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-family: monospace;
        }
        
        .path-arrow {
            margin: 0 10px;
            color: #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Beauty Platform - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</h1>
        
        <div class="problem-section">
            <div class="problem-title">üö® –¢–ï–ö–£–©–ê–Ø –ü–†–û–ë–õ–ï–ú–ê</div>
            <p><strong>–°–∏–º–ø—Ç–æ–º:</strong> Admin Panel –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è - –ø–æ–ª—É—á–∞–µ—Ç 404/500 –æ—à–∏–±–∫–∏</p>
            <p><strong>–û–∂–∏–¥–∞–µ–º—ã–π –ø–æ—Ç–æ–∫:</strong> Admin Panel ‚Üí API Gateway ‚Üí Auth Service ‚Üí Response</p>
            <p><strong>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:</strong> API Gateway –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, –Ω–æ —á—Ç–æ-—Ç–æ –∏–¥–µ—Ç –Ω–µ —Ç–∞–∫</p>
        </div>
        
        <h2>üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (–ü–æ—à–∞–≥–æ–≤—ã–π –ø–æ—Ç–æ–∫)</h2>
        
        <div class="flow-diagram">
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <div class="step-title">–ë—Ä–∞—É–∑–µ—Ä ‚Üí Admin Panel</div>
                    <div class="step-details">https://test-admin.beauty.designcorp.eu/login ‚Üí POST /api/auth/login</div>
                </div>
            </div>
            
            <div class="arrow">‚¨áÔ∏è</div>
            
            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <div class="step-title">Admin Panel ‚Üí Vite Proxy</div>
                    <div class="step-details">vite.config.ts proxy: /api ‚Üí http://localhost:6020</div>
                </div>
            </div>
            
            <div class="arrow">‚¨áÔ∏è</div>
            
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <div class="step-title">Vite Proxy ‚Üí API Gateway</div>
                    <div class="step-details">http://localhost:6020/api/auth/login</div>
                </div>
            </div>
            
            <div class="arrow">‚¨áÔ∏è</div>
            
            <div class="step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <div class="step-title">API Gateway ‚Üí Express Router</div>
                    <div class="step-details">app.use('/api', proxyRoutes) ‚Üí –æ–±—Ä–µ–∑–∞–µ—Ç /api, –æ—Å—Ç–∞–µ—Ç—Å—è /auth/login</div>
                </div>
            </div>
            
            <div class="arrow">‚¨áÔ∏è</div>
            
            <div class="step">
                <div class="step-number">5</div>
                <div class="step-content">
                    <div class="step-title">Proxy Router ‚Üí Auth Service</div>
                    <div class="step-details">–ò—â–µ—Ç route path='/auth' ‚Üí proxy –Ω–∞ http://localhost:6021/auth/login</div>
                </div>
            </div>
            
            <div class="arrow">‚¨áÔ∏è</div>
            
            <div class="step">
                <div class="step-number">6</div>
                <div class="step-content">
                    <div class="step-title">Auth Service Response</div>
                    <div class="step-details">‚ùå 404 "Endpoint not found" –∏–ª–∏ ‚úÖ 200 Success</div>
                </div>
            </div>
        </div>
        
        <div class="path-trace">
            <h3>üîç Trace –∑–∞–ø—Ä–æ—Å–∞ /api/auth/login:</h3>
            <div class="path-step">
                <code>https://test-admin.beauty.designcorp.eu</code>
                <span class="path-arrow">‚Üí</span>
                <code>/api/auth/login</code>
            </div>
            <div class="path-step">
                <code>Vite Proxy (6002)</code>
                <span class="path-arrow">‚Üí</span>
                <code>localhost:6020/api/auth/login</code>
            </div>
            <div class="path-step">
                <code>API Gateway (6020)</code>
                <span class="path-arrow">‚Üí</span>
                <code>/auth/login (–ø–æ—Å–ª–µ –æ–±—Ä–µ–∑–∫–∏ /api)</code>
            </div>
            <div class="path-step">
                <code>Proxy Route</code>
                <span class="path-arrow">‚Üí</span>
                <code>localhost:6021/auth/login</code>
            </div>
            <div class="path-step">
                <code>Auth Service (6021)</code>
                <span class="path-arrow">‚Üí</span>
                <code>‚ùì –†–µ–∑—É–ª—å—Ç–∞—Ç</code>
            </div>
        </div>
        
        <h2>üõ†Ô∏è –°–µ—Ä–≤–∏—Å—ã –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å</h2>
        
        <div class="services-grid">
            <div class="service-card active">
                <div class="service-title">
                    <span class="status-indicator status-active"></span>
                    API Gateway (6020)
                </div>
                <div class="service-info">
                    <strong>–†–æ–ª—å:</strong> –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞<br>
                    <strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –ó–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ PM2<br>
                    <strong>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</strong> app.use('/api', proxyRoutes)
                </div>
                <div class="endpoints">
                    <div class="endpoint">GET /health</div>
                    <div class="endpoint">POST /api/auth/* ‚Üí localhost:6021</div>
                    <div class="endpoint">GET /api/images/* ‚Üí localhost:6026</div>
                </div>
            </div>
            
            <div class="service-card active">
                <div class="service-title">
                    <span class="status-indicator status-active"></span>
                    Auth Service (6021)
                </div>
                <div class="service-info">
                    <strong>–†–æ–ª—å:</strong> JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è<br>
                    <strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –ó–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ PM2<br>
                    <strong>Health:</strong> ‚úÖ /auth/health —Ä–∞–±–æ—Ç–∞–µ—Ç
                </div>
                <div class="endpoints">
                    <div class="endpoint">GET /auth/health</div>
                    <div class="endpoint">GET /auth/me</div>
                    <div class="endpoint">POST /auth/login</div>
                    <div class="endpoint">POST /auth/refresh</div>
                </div>
            </div>
            
            <div class="service-card active">
                <div class="service-title">
                    <span class="status-indicator status-active"></span>
                    Admin Panel (6002)
                </div>
                <div class="service-info">
                    <strong>–†–æ–ª—å:</strong> React –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å<br>
                    <strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –ó–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ PM2<br>
                    <strong>Proxy:</strong> /api ‚Üí localhost:6020
                </div>
                <div class="endpoints">
                    <div class="endpoint">Frontend: React + Vite</div>
                    <div class="endpoint">API calls: /api/auth/*</div>
                    <div class="endpoint">Domain: test-admin.beauty.designcorp.eu</div>
                </div>
            </div>
            
            <div class="service-card active">
                <div class="service-title">
                    <span class="status-indicator status-active"></span>
                    Images API (6026)
                </div>
                <div class="service-info">
                    <strong>–†–æ–ª—å:</strong> –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br>
                    <strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –ó–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ PM2<br>
                    <strong>Endpoints:</strong> /api/images/*
                </div>
                <div class="endpoints">
                    <div class="endpoint">POST /api/images/upload</div>
                    <div class="endpoint">GET /api/images/list</div>
                    <div class="endpoint">DELETE /api/images/:id</div>
                </div>
            </div>
        </div>
        
        <h2>üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã</h2>
        
        <div class="command-box">
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API Gateway
curl -s "http://localhost:6020/health" | head -3

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Auth Service –Ω–∞–ø—Ä—è–º—É—é  
curl -s "http://localhost:6021/auth/health" | head -3

# –ü—Ä–æ–≤–µ—Ä–∫–∞ proxy auth —á–µ—Ä–µ–∑ Gateway
curl -s "http://localhost:6020/api/auth/me" | head -3

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Gateway
pm2 logs beauty-api-gateway --lines 5

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 list | grep beauty
        </div>
        
        <div class="test-results" id="testResults">
            <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:</h3>
            <div class="test-item test-fail">
                <span class="test-icon">‚ùå</span>
                <span>API Gateway /api/auth/me ‚Üí 404 "Endpoint not found"</span>
            </div>
            <div class="test-item test-pass">
                <span class="test-icon">‚úÖ</span>
                <span>Auth Service /auth/health ‚Üí 200 Success</span>
            </div>
            <div class="test-item test-fail">
                <span class="test-icon">‚ùå</span>
                <span>Admin Panel login ‚Üí 500 Internal Error</span>
            </div>
        </div>
        
        <div class="problem-section">
            <div class="problem-title">üîß –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø</div>
            <ol>
                <li><strong>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ—É—Ç–∏–Ω–≥ Auth Service:</strong> –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ /auth/login, /auth/me endpoints –ø–æ–¥–∫–ª—é—á–µ–Ω—ã</li>
                <li><strong>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å proxy configuration:</strong> –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ pathRewrite –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π</li>
                <li><strong>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å middleware order:</strong> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ middleware –≤ Auth Service</li>
                <li><strong>–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> –£–≤–∏–¥–µ—Ç—å –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç</li>
                <li><strong>–¢–µ—Å—Ç –Ω–∞–ø—Ä—è–º—É—é:</strong> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Auth Service endpoints –±–µ–∑ Gateway</li>
            </ol>
        </div>
        
        <div style="text-align: center; margin-top: 40px; color: #7f8c8d;">
            <p><strong>Beauty Platform Debug Tool</strong> | –°–æ–∑–¥–∞–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤</p>
            <p>–û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="timestamp"></span></p>
        </div>
    </div>
    
    <script>
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É/–≤—Ä–µ–º—è
        document.getElementById('timestamp').textContent = new Date().toLocaleString('ru-RU');
        
        // –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
        document.querySelectorAll('.service-card').forEach(card => {
            card.addEventListener('click', function() {
                this.style.transform = this.style.transform === 'scale(1.02)' ? 'scale(1)' : 'scale(1.02)';
            });
        });
    </script>
</body>
</html>